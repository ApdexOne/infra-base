apiVersion: argoproj.io/v1alpha1
kind: Workflow
metadata:
  name: pull-build-test-1
  generateName: pull-build-test-
  namespace: argo
spec:
  serviceAccountName: workflow
  entrypoint: build
  volumes:
  - name: regcred
    secret:
      secretName: regcred
      items:
        - key: .dockerconfigjson
          path: config.json
  templates:
    - name: build
      dag:
        tasks:
          - name: build
            templateRef:
              name: container-image
              template: build-kaniko-git
              clusterScope: true
            arguments:
              parameters:
                - name: repo_url
                  value: git@git.gitea-ssh.services.svc:ApdexOne/pipeline-demo.git
                - name: container_image
                  value: norgefajardo/cypress
                - name: container_tag
                  value: "0.0.1"
